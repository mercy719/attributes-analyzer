# 产品属性增强工具使用说明SOP

## 1. 系统概述

### 1.1 工具功能
本工具是一个基于AI的产品属性增强系统，能够自动从产品描述文本中提取和标准化产品属性信息。

### 1.2 核心特性
- 支持Excel(.xlsx, .xls)和CSV文件处理
- 基于LLM（大语言模型）的智能属性提取
- 中文统一输出格式
- 多线程并行处理
- 断点续传和错误恢复
- 实时任务状态监控

### 1.3 系统要求
- Python 3.7+
- 网络连接（用于访问LLM API）
- 支持现代Web浏览器

## 2. 启动系统

### 2.1 环境准备
```bash
# 进入项目目录
cd /Users/leqee/Documents/Cursor\ Projects/air-styler-analysis

# 激活虚拟环境
source venv/bin/activate

# 启动应用
python app.py
```

### 2.2 访问地址
- 本地访问：`http://localhost:5001`
- 网络访问：`http://[您的IP地址]:5001`

## 3. 操作流程

### 3.1 文件上传与预览

#### 步骤1：选择文件
1. 点击"选择文件"按钮
2. 选择要处理的Excel或CSV文件
3. 支持的文件格式：`.xlsx`, `.xls`, `.csv`
4. 文件大小限制：最大16MB

#### 步骤2：预览文件内容
1. 文件选择后，系统自动显示文件预览
2. 预览内容包括：
   - 所有列名列表
   - 前5行数据样本
3. 确认数据格式正确后继续下一步

### 3.2 配置处理参数

#### 步骤3：选择文本列
1. 从"选择要分析的文本列"下拉框中选择包含产品描述的列
2. 可以选择多个列（如产品名称、描述、规格等）
3. 建议选择信息最丰富的文本列

#### 步骤4：设置要提取的属性
1. 在"要提取的属性"文本框中输入属性名称
2. 每行一个属性，例如：
   ```
   品牌
   颜色
   容量
   功率
   重量
   材质
   ```

#### 步骤5：配置自定义提示（可选）
1. 点击"显示高级选项"
2. 为特定属性添加详细说明，格式为：
   ```json
   {
     "颜色": "请提取产品的主要颜色，统一使用中文表达",
     "容量": "请提取容量信息，统一使用L（升）为单位",
     "功率": "请提取功率信息，统一使用W（瓦特）为单位"
   }
   ```

#### 步骤6：API配置
1. **API密钥**：默认使用系统配置的DeepSeek API密钥
2. **服务提供商**：默认选择"deepseek"
3. 如需使用其他API，请更换相应的密钥和提供商

### 3.3 开始处理

#### 步骤7：提交任务
1. 确认所有配置无误后，点击"开始处理"按钮
2. 系统生成唯一任务ID
3. 文件开始后台处理

#### 步骤8：监控处理进度
1. 系统自动跳转到任务状态页面
2. 实时显示处理进度百分比
3. 显示当前处理状态：
   - 等待处理
   - 正在处理
   - 已完成
   - 出错

### 3.4 结果下载

#### 步骤9：下载处理结果
1. 任务完成后，点击"下载结果"按钮
2. 下载的文件名格式：`原文件名_enhanced_时间戳.xlsx`
3. 文件包含原始数据和新提取的属性列

## 4. 数据格式规范

### 4.1 输出标准化

#### 4.1.1 语言统一
工具会自动将所有提取的属性值统一转换为中文输出，无论原始数据是什么语言。

**示例转换**：
- 英文：`"Color: Black"` → 提取结果：`"黑色"`
- 德文：`"Farbe: Schwarz"` → 提取结果：`"黑色"`
- 日文：`"色：黒"` → 提取结果：`"黑色"`

#### 4.1.2 单位统一
系统会自动识别并统一各种计量单位，确保数据的一致性。

**支持的单位转换**：

| 属性类型 | 原始单位示例 | 统一输出格式 | 转换示例 |
|---------|-------------|-------------|----------|
| 容量 | ml, mL, 毫升, liter, 升 | L（升） | `500ml` → `0.5L` |
| 重量 | g, 克, pound, lb, 磅 | kg（千克） | `1500g` → `1.5kg` |
| 功率 | watt, 瓦, kW, 千瓦 | W（瓦特） | `1.2kW` → `1200W` |
| 长度 | mm, 毫米, inch, 英寸, m, 米 | cm（厘米） | `50mm` → `5cm` |
| 温度 | °F, 华氏度, K, 开尔文 | °C（摄氏度） | `212°F` → `100°C` |

#### 4.1.3 数值格式规范
- **无空格**：数值与单位之间不留空格
  - ✅ 正确：`1.5L`、`1200W`、`25°C`
  - ❌ 错误：`1.5 L`、`1200 W`、`25 °C`

- **小数位数**：小数点后最多保留1位
  - ✅ 正确：`1.5L`、`2.8kg`
  - ❌ 错误：`1.567L`、`2.833kg`

- **整数显示**：能整除的数值不显示小数点
  - ✅ 正确：`2L`、`1200W`
  - ❌ 错误：`2.0L`、`1200.0W`

#### 4.1.4 数据完整性
- **确定信息**：只提取AI确认存在的属性信息
- **空值处理**：不确定的属性保持为空（null），不进行猜测
- **格式验证**：提取的数据会进行格式验证，确保符合标准

#### 4.1.5 实际应用示例

**原始产品描述**：
```
"Dyson V15 Detect Absolute Cordless Vacuum - 1.5 liter capacity, 
750W motor, weighs 3.2 pounds, temperature range 32-140°F"
```

**提取结果**：
```json
{
  "品牌": "Dyson",
  "型号": "V15 Detect Absolute",
  "容量": "1.5L",
  "功率": "750W",
  "重量": "1.5kg",
  "温度范围": "0-60°C"
}
```

### 4.2 颜色标准化

#### 4.2.1 多语言颜色识别
系统能够识别多种语言的颜色表达并统一转换为中文。

**常见颜色转换表**：

| 中文标准 | 英文 | 德文 | 法文 | 日文 |
|---------|------|------|------|------|
| 黑色 | black, dark | schwarz | noir | 黒、黒色 |
| 白色 | white | weiß, weiss | blanc | 白、白色 |
| 红色 | red | rot | rouge | 赤、赤色 |
| 蓝色 | blue | blau | bleu | 青、青色 |
| 绿色 | green | grün | vert | 緑、緑色 |
| 黄色 | yellow | gelb | jaune | 黄、黄色 |
| 灰色 | gray, grey | grau | gris | 灰、灰色 |
| 银色 | silver | silber | argent | 銀、銀色 |
| 金色 | gold, golden | gold | or | 金、金色 |

#### 4.2.2 特殊颜色处理
- **渐变色**：`"黑白渐变"` 或 `"多色"`
- **透明色**：`"透明"` 或 `"半透明"`
- **金属色**：`"金属银"` 或 `"金属黑"`
- **未知颜色**：保持为空，不进行猜测

### 4.3 标准化的实际意义

#### 4.3.1 为什么需要标准化？
在处理来自不同来源的产品数据时，经常会遇到以下问题：
- **语言混杂**：同一个产品库中可能包含中文、英文、德文等多种语言描述
- **单位不统一**：重量可能用克、千克、磅等不同单位表示
- **格式混乱**：数值格式不一致，影响后续数据分析

#### 4.3.2 标准化的好处
1. **数据一致性**：所有产品属性使用统一的格式和单位
2. **便于分析**：标准化后的数据可以直接用于统计分析和比较
3. **提高效率**：减少人工数据清理的工作量
4. **避免错误**：减少因格式不一致导致的数据处理错误

#### 4.3.3 标准化前后对比示例

**处理前的原始数据**：
```
产品A: "重量：2.5 pounds, 容量：1500ml, 颜色：black"
产品B: "Weight: 1.2kg, Volume: 0.8L, Color: schwarz"  
产品C: "重さ：800g, 容量：2升, 色：黒"
```

**标准化后的数据**：
```json
{
  "产品A": {"重量": "1.1kg", "容量": "1.5L", "颜色": "黑色"},
  "产品B": {"重量": "1.2kg", "容量": "0.8L", "颜色": "黑色"},
  "产品C": {"重量": "0.8kg", "容量": "2L", "颜色": "黑色"}
}
```

这样标准化后，您就可以轻松地：
- 按重量对产品进行排序
- 计算平均容量
- 统计各颜色产品的数量
- 进行价格与规格的关联分析

## 5. 任务管理

### 5.1 查看所有任务
1. 访问：`http://localhost:5001/tasks`
2. 查看所有历史任务状态
3. 包含任务ID、文件名、状态、进度等信息

### 5.2 查看特定任务
1. 访问：`http://localhost:5001/task/{任务ID}`
2. 查看具体任务的详细信息

### 5.3 断点续传
- 系统自动保存处理进度
- 意外中断后重新启动会从断点继续
- 检查点文件自动管理，无需手动干预

## 6. 故障排除

### 6.1 常见问题

#### 问题1：文件上传失败
**可能原因**：
- 文件格式不支持
- 文件大小超过16MB
- 文件损坏

**解决方案**：
- 确认文件格式为.xlsx/.xls/.csv
- 压缩文件大小或分割大文件
- 检查文件是否完整

#### 问题2：预览显示错误
**可能原因**：
- 文件编码问题
- 文件格式异常
- 数据包含特殊字符

**解决方案**：
- 确保CSV文件使用UTF-8编码
- 检查Excel文件是否正常打开
- 清理数据中的特殊字符

#### 问题3：处理进度停滞
**可能原因**：
- API调用超时
- 网络连接问题
- 服务器负载过高

**解决方案**：
- 检查网络连接
- 等待系统自动重试
- 重新启动应用程序

#### 问题4：属性提取不准确
**可能原因**：
- 文本描述信息不足
- 属性名称不够明确
- 缺少自定义提示

**解决方案**：
- 选择信息更丰富的文本列
- 使用更具体的属性名称
- 添加详细的自定义提示

### 6.2 错误代码说明

| 错误代码 | 说明 | 解决方案 |
|---------|------|----------|
| 400 | 请求参数错误 | 检查上传文件和参数配置 |
| 404 | 任务或文件不存在 | 确认任务ID或文件路径正确 |
| 500 | 服务器内部错误 | 查看控制台日志，重启应用 |

### 6.3 日志查看
- 应用运行日志显示在控制台
- 关键错误信息会打印到终端
- 检查点文件位于`results/`目录

## 7. 性能优化建议

### 7.1 处理效率
- **文件大小**：建议单次处理不超过1000行数据
- **并发处理**：系统默认使用5个线程并行处理
- **网络稳定性**：确保稳定的网络连接以避免API调用失败

### 7.2 结果质量
- **文本质量**：选择信息丰富、描述详细的文本列
- **属性明确性**：使用具体、明确的属性名称
- **自定义提示**：为复杂属性添加详细的提取说明

## 8. 安全注意事项

### 8.1 数据安全
- 上传的文件临时存储在本地
- 处理完成后及时下载结果
- 定期清理临时文件

### 8.2 API安全
- 妥善保管API密钥
- 注意API调用频率限制
- 监控API使用量

## 9. 维护说明

### 9.1 定期维护
- 清理`uploads/`和`results/`目录中的临时文件
- 检查磁盘空间使用情况
- 更新依赖包版本

### 9.2 备份建议
- 定期备份重要的处理结果
- 保存任务配置模板
- 记录常用的自定义提示

## 10. 联系支持

如遇到技术问题或需要功能扩展，请联系开发团队或查看项目文档。

---

**版本信息**：v1.0  
**更新日期**：2025年1月  
**适用范围**：产品属性增强工具 